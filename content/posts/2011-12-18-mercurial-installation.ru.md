---
title: Mercurial Installation
date: 2011-12-18T12:52:00Z
tags: [mercurial, server]
---

Mercurial — распределённая система контроля версий (SCM). От остальных отличается простотой использования и, как следствие, маленьким временем освоения новичками. При этом mercurial достаточно функционален для подавляющего количества задач.

В этой статье я опишу как создать на мой взгляд достаточно стандартную конфигурацию, которая удовлетворит нужды большинства небольших групп разработчиков. В целом установка mercurial'а не сложна, но может вызвать некоторые трудности у непосвящённых.

Хотя распределённые SCM не нуждаются в центральном репозитории (repository), обычно бывает очень полезно иметь «интеграционный» репозиторий в качестве того места, откуда всегда можно получить актуальное состояние разработки от всех разработчиков, и места обмена наборами изменений (changesets).

Итак, интеграционный репозиторий будет храниться на linux-сервере, к которому имеется доступ по SSH. Плюсом такой конфигурации является также возможность доступа к репозиторию удалённых разработчиков, если сервер имеет доступ в интернет.

Для начала в целях безопасности нужно создать группу пользователей в `/etc/groups`, содержащую всех разработчиков, которые должны иметь доступ к хранилищу. В качестве примера такой группой будет `scm`. Как создать группу и добавить туда пользователей смотрите документацию вашего дистрибутива. Репозиторий у нас будут находиться в каталоге `/hgrepo`. Создадим новое хранилище и запретим доступ к нему всех, кто не входит в группу `scm`:

```shell
$ cd /hgrepo
$ hg init myrepo
```

Репозиторий создан и уже практически готов к работе. Установим права доступа к репозиторию:

```shell
# chgrp -R scm myrepo # устанавливаем группу доступа к репозиторию
# chmod -R o= myrepo # запрещаем доступ для всех, кто не входит в группу scm
# chmod -R g+w myrepo # установим право записи в репозиторий для группы
# find myrepo -type d -exec chmod g+s {} ; # все новые файлы и каталоги будут иметь группу scm
```

Для удобства доступа к репозиторию создадим символическую ссылку в корне:

```shell
$ cd /
# ln -s /hgrepo/myrepo
```

Всё готово. Чтобы воспользоваться репозиторием, у разработчиков должен быть установлен mercurial версии не ниже той, что на сервере и прописано имя пользователя в файле `.hgrc` в домашнем каталоге пользователя. Версию mercurial'а можно проверить командой:

```shell
$ hg --version
```

Для того, чтобы сделать клон, выполните:

```shell
$ hg clone ssh://<username>@<servername>//hgrepo
```

Обратите внимание на двойной слеш перед именем репозитория. Это указание на то, что путь указывается относительно корня файловой системы, а не относительно домашнего каталога пользователя, как бывает по умолчанию.

## Ссылки:

[http://ru.wikipedia.org/wiki/Mercurial](http://ru.wikipedia.org/wiki/Mercurial)

[http://mercurial.selenic.com/wiki/MultipleCommitters](http://mercurial.selenic.com/wiki/MultipleCommitters)
